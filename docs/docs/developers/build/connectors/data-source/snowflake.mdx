---
title: Snowflake
description: Connect to data in Snowflake
sidebar_label: Snowflake
sidebar_position: 75
---

import { TwoStepFlowIntro, EnvPullTip, DevProdSeparation, DeployToCloud } from '@site/src/components/connector';

{/* WARNING: There are links to this page in source code. If you move it, find and replace the links and consider adding a redirect in docusaurus.config.js. */}

:::info Deprecation of password authentication

Snowflake has issued a [deprecation notice](https://www.snowflake.com/en/blog/blocking-single-factor-password-authentification/) for single-factor password authentication. Rill supports and recommends using private key authentication to avoid any disruption of your service.

:::

## Overview

[Snowflake](https://docs.snowflake.com/en/user-guide-intro) is a cloud-based data platform designed to facilitate data warehousing, data lakes, data engineering, data science, data application development, and data sharing. It separates compute and storage, enabling users to scale up or down instantly without downtime, providing a cost-effective solution for data management. With its unique architecture and support for multi-cloud environments, including AWS, Azure, and Google Cloud Platform, Snowflake offers seamless data integration, secure data sharing across organizations, and real-time access to data insights, making it a common choice to power many business intelligence applications and use cases. You can connect to and read from Snowflake data warehouses using the [Go Snowflake Driver](https://pkg.go.dev/github.com/snowflakedb/gosnowflake).

## Authentication Methods

To connect to Snowflake, you need to provide authentication credentials. Rill supports two methods:

1. **Use Keypair Authentication** (recommended - required for production)
2. **Use Password Authentication** (deprecated by Snowflake)

:::tip Authentication Methods
Snowflake has deprecated single-factor password authentication. We strongly recommend using keypair authentication to ensure uninterrupted service.
:::

<TwoStepFlowIntro
  connector="Snowflake"
  step1Description="Set up your Snowflake connector with credentials via connection string"
  step2Description="Define which database, schema, table, or query to execute"
/>

## Method 1: Keypair Authentication (Recommended)

Keypair authentication provides enhanced security and is the recommended method for connecting to Snowflake. This method works for both local development and Rill Cloud deployments.

### Connection String Format

Use the following syntax when defining a connection string using a private key:

```sql
<username>@<account_identifier>/<database>/<schema>?warehouse=<warehouse>&role=<role>&authenticator=SNOWFLAKE_JWT&privateKey=<privateKey_url_safe>
```

See the [Appendix](#using-keypair-authentication) for detailed instructions on generating and formatting your private key.

<img src='/img/build/connectors/data-sources/snowflake_conn_strings.png' class='rounded-gif' />
<br />

:::info Finding the Snowflake account identifier

To determine your [Snowflake account identifier](https://docs.snowflake.com/en/user-guide/admin-account-identifier), one easy way is to check your Snowflake account URL. The account identifier to use in your connection string should be everything before `.snowflakecomputing.com`!

:::

### Using the UI

1. Click **Add Data** in your Rill project
2. Select **Snowflake** as the data source type
3. In the authentication step:
   - Enter your connection string with keypair authentication
4. In the data model configuration step, enter your SQL query
5. Click **Create** to finalize

After the model YAML is generated, you can add additional [model settings](/developers/build/models/source-models) directly to the file.

### Manual Configuration

If you prefer to configure manually, create two files:

**Step 1: Create connector configuration**

Create `connectors/my_snowflake.yaml`:

```yaml
type: connector
driver: snowflake

dsn: "{{ .env.connector.snowflake.dsn }}"
```

**Step 2: Create model configuration**

Create `models/my_snowflake_data.yaml`:

```yaml
type: model
connector: my_snowflake

sql: SELECT * FROM my_database.my_schema.my_table

# Add a refresh schedule
refresh:
  cron: "0 */6 * * *"
```

**Step 3: Add credentials to `.env`**

```bash
connector.snowflake.dsn=myuser@myaccount/mydb/myschema?warehouse=mywh&role=myrole&authenticator=SNOWFLAKE_JWT&privateKey=<your_url_safe_private_key>
```

<EnvPullTip />

## Method 2: Password Authentication (Deprecated)

:::warning Deprecated by Snowflake
Snowflake has deprecated single-factor password authentication. This method may stop working in the future. We strongly recommend migrating to keypair authentication.
:::

### Connection String Format

```sql
<username>:<password>@<account_identifier>/<database>/<schema>?warehouse=<warehouse>&role=<role>
```

### Manual Configuration

**Step 1: Create connector configuration**

Create `connectors/my_snowflake.yaml`:

```yaml
type: connector
driver: snowflake

dsn: "{{ .env.connector.snowflake.dsn }}"
```

**Step 2: Create model configuration**

Create `models/my_snowflake_data.yaml`:

```yaml
type: model
connector: my_snowflake

sql: SELECT * FROM my_database.my_schema.my_table

# Add a refresh schedule
refresh:
  cron: "0 */6 * * *"
```

**Step 3: Add credentials to `.env`**

```bash
connector.snowflake.dsn=myuser:mypassword@myaccount/mydb/myschema?warehouse=mywh&role=myrole
```

## Separating Dev and Prod Environments

<DevProdSeparation />

## Deploy to Rill Cloud

<DeployToCloud
  connector="Snowflake"
  connectorId="snowflake"
  credentialDescription="Snowflake credentials via the connection string as a source configuration `dsn` field"
/>

## Appendix

### Using Keypair Authentication

You can use keypair authentication for enhanced security when connecting to Snowflake as an alternative to password-based authentication, which Snowflake has deprecated. Per the [Snowflake Go Driver](https://github.com/snowflakedb/gosnowflake) specifications, this requires the following changes to the dsn:
- Remove the password
- Add `authenticator=SNOWFLAKE_JWT`
- Add `privateKey=<privateKey_url_safe>`

```sql
<username>@<account_identifier>/<database>/<schema>?warehouse=<warehouse>&role=<role>&authenticator=SNOWFLAKE_JWT&privateKey=<privateKey_url_safe>
```

#### Generate a Private Key

Please refer to the [Snowflake documentation](https://docs.snowflake.com/en/guide/key-pair-auth) on how to configure an unencrypted private key to use in Rill.

The Snowflake Go Driver only supports **unencrypted PKCS#8 keys**. Make sure to include the `-nocrypt` flag, as encrypted keys are not supported. You can generate one using:

```bash
# Generate a 2048-bit unencrypted PKCS#8 private key
openssl genrsa 2048 | openssl pkcs8 -topk8 -inform PEM -out rsa_key.p8 -nocrypt
```

#### Convert the Private Key to a URL-Safe Format for the DSN

After generating the private key, you need to convert it into a URL-safe Base64 format for use in the Snowflake DSN. Run the following command:

```bash
# Convert URL safe format for DSN
cat rsa_key.p8 | grep -v "\----" | tr -d '\n' | tr '+/' '-_'
```

> Note: When copying the output, do not include the trailing % character that may appear in your terminal.

:::info Check your OS version

Depending on your OS version, above commands may differ slightly. Please check your OS reference manual for the correct syntax.

:::


:::tip Best Practices

If using keypair authentication, consider rotating your public key regularly to ensure compliance with security and governance best practices.

:::
