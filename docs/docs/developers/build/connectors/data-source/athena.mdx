---
title: Athena
description: Connect to Amazon Athena for serverless querying of data stored in S3
sidebar_label: Athena
sidebar_position: 0
---

import { TwoStepFlowIntro, EnvPullTip, DevProdSeparation, DeployToCloud } from '@site/src/components/connector';

{/* WARNING: There are links to this page in source code. If you move it, find and replace the links and consider adding a redirect in docusaurus.config.js. */}

## Overview

[Amazon Athena](https://docs.aws.amazon.com/athena/) is an interactive query service that makes it easy to analyze data directly in Amazon S3 using standard SQL. It is serverless, so there is no infrastructure to manage, and you pay only for the queries you run, making it cost-effective for a wide range of data analysis tasks. Athena is designed for quick, ad-hoc querying of large datasets, enabling businesses to easily integrate it into their analytics and business intelligence tools for immediate insights from their data stored in S3. Rill supports natively connecting to and reading from Athena as a source by leveraging the [AWS SDK for Go](https://aws.github.io/aws-sdk-go-v2/docs/).

## Authentication Methods

To connect to Amazon Athena, you need to provide authentication credentials. Rill supports two methods:

1. **Use Access Key/Secret Key** (recommended for production)
2. **Use Local AWS credentials** (local development only - not recommended for production)

<TwoStepFlowIntro
  connector="Athena"
  step1Description="Set up your Athena connector with AWS credentials (Access Key/Secret Key)"
  step2Description="Define which database, table, or query to execute"
/>

## Method 1: Access Key and Secret Key (Recommended)

Access Key and Secret Key credentials provide the most reliable authentication for Athena. This method works for both local development and Rill Cloud deployments.

### Using the UI

1. Click **Add Data** in your Rill project
2. Select **Amazon Athena** as the data source type
3. In the authentication step:
   - Enter your AWS Access Key ID
   - Enter your AWS Secret Access Key
   - Specify the output location (S3 bucket for query results)
   - Specify the AWS region
4. In the data model configuration step, enter your SQL query
5. Click **Create** to finalize

After the model YAML is generated, you can add additional [model settings](/developers/build/models/source-models) directly to the file.

### Manual Configuration

If you prefer to configure manually:

**Step 1: Create connector configuration**

Create `connectors/my_athena.yaml`:

```yaml
type: connector
driver: athena

aws_access_key_id: "{{ .env.connector.athena.aws_access_key_id }}"
aws_secret_access_key: "{{ .env.connector.athena.aws_secret_access_key }}"
output_location: "s3://my-bucket/athena-results/"
region: "us-east-1"
```

**Step 2: Add credentials to `.env`**

```bash
connector.athena.aws_access_key_id=AKIAIOSFODNN7EXAMPLE
connector.athena.aws_secret_access_key=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
```

<EnvPullTip />

## Method 2: Local AWS Credentials

For local development, you can use credentials from the AWS CLI. This method is **not suitable for production** or Rill Cloud deployments.

:::warning Not recommended for production
Local AWS credentials only work for local development. If you deploy to Rill Cloud using this method, your dashboards will fail. Always use Access Key/Secret Key for production deployments.
:::

### Setup

1. Install the [AWS CLI](https://docs.aws.amazon.com/cli/latest/userguide/getting-started-install.html) if not already installed
2. Authenticate with your AWS account:
   - If your organization has SSO configured, reach out to your admin for instructions on how to authenticate using `aws sso login`
   - Otherwise, run `aws configure` and provide your access key, secret, and default region
3. Verify your authentication:
   ```bash
   aws iam get-user --no-cli-pager
   ```

### Manual Configuration

Create `connectors/athena.yaml`:

```yaml
type: connector
driver: athena

output_location: "s3://my-bucket/athena-results/"
region: "us-east-1"
```

When no explicit credentials are provided in the connector, Rill will automatically use your local AWS CLI credentials.

## Create Your First Model

Once your connector is configured using any method above, create a model to define what data to pull.

Create `models/my_athena_data.yaml`:

```yaml
type: model
connector: athena
dev:
   sql: SELECT * FROM my_database.my_table limit 10000

sql: `SELECT * FROM my_database.my_table 

```

After creating the model, you can add additional [model settings](/developers/build/models/source-models) directly to the file.

## Separating Dev and Prod Environments

<DevProdSeparation />

## Deploy to Rill Cloud

<DeployToCloud
  connector="Athena"
  connectorId="athena"
  credentialDescription="an access key and secret for an AWS service account"
/>

## Appendix

### Athena/S3 Permissions

The Athena connector performs the following AWS queries while ingesting data from Athena:

1. Athena: [`GetWorkGroup`](https://docs.aws.amazon.com/athena/latest/APIReference/API_GetWorkGroup.html) to determine an output location if not specified explicitly.
2. S3: [`ListObjects`](https://docs.aws.amazon.com/AmazonS3/latest/API/API_ListObjects.html) to identify files unloaded by Athena.
3. S3: [`GetObject`](https://docs.aws.amazon.com/AmazonS3/latest/API/API_GetObject.html) to ingest files unloaded by Athena.

Make sure your account or service account has the corresponding permissions to perform these requests.

### How to Create an AWS Service Account

For detailed instructions on creating an AWS service account with the appropriate permissions, see the [S3 connector documentation](./s3#how-to-create-an-aws-service-account-using-the-aws-management-console).
