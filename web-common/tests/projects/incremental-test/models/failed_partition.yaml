# Model YAML
# Reference documentation: https://docs.rilldata.com/reference/project-files/models
#
# NOTE: This glob intentionally includes malformed CSV files in the bucket
# to trigger partition errors for E2E testing of "Refresh Errored Partitions"

type: model
materialize: true

connector: duckdb

create_secrets_from_connectors: gcs
incremental: true

# Matches all CSV files including malformed ones that will fail parsing
partitions:
  glob: gs://rilldata-public/e2e/incremental/*.csv

sql: |
  select *
  from read_csv(
    '{{.partition.uri}}',
    header=true,
    auto_detect=1,
    ignore_errors=0
  )
