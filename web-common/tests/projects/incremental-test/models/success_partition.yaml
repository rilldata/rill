# Model YAML
# Reference documentation: https://docs.rilldata.com/reference/project-files/models
#
# NOTE: This glob only matches well-formed CSV files (dt*.csv pattern)
# to ensure this model completes without partition errors

type: model
materialize: true

connector: duckdb

create_secrets_from_connectors: gcs
incremental: true

# Matches only valid dt*.csv files, avoiding malformed ones
partitions:
  glob: gs://rilldata-public/e2e/incremental/dt*.csv

sql: |
  select *
  from read_csv(
    '{{.partition.uri}}',
    header=true,
    auto_detect=1,
    ignore_errors=0
  )
