# This should be used for docs also
#
# Content-Security-Policy is intentionally absent from the static headers below.
# It is set dynamically by the netlify/edge-functions/csp-nonce.ts edge function,
# which generates a per-request nonce, injects it into all <script> tags, and
# builds the full CSP header with 'strict-dynamic'. This eliminates the host
# allowlist bypass risk while maintaining compatibility with SvelteKit, Pylon,
# and CodeMirror.

[[edge_functions]]
  function = "csp-nonce"
  path = "/*"

# Security headers for all routes (CSP is handled by the edge function above)
[[headers]]
  for = "/*"
  [headers.values]
    Permissions-Policy = "geolocation=(),midi=(),sync-xhr=(self),microphone=(),camera=(),magnetometer=(),gyroscope=(),fullscreen=(self),payment=()"
    Referrer-Policy = "no-referrer"
    X-Content-Type-Options = "nosniff"
    Cross-Origin-Embedder-Policy = "credentialless"
    Cross-Origin-Opener-Policy = "unsafe-none"
    Cross-Origin-Resource-Policy = "cross-origin"
    Strict-Transport-Security = "max-age=31536000; includeSubDomains; preload"
