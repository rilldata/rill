expensive: true
connectors:
  - clickhouse
  - https
project_files:
  https_to_clickhouse.yaml:
    type: model
    materialize: true
    connector: https
    path: '{{.env.connector.https.endpoint}}'
    format: csv
    output: clickhouse
  https_to_duckdb.yaml:
    type: model
    connector: duckdb
    sql: select * from read_csv('{{.env.connector.https.endpoint}}')
    format: csv
tests:
  - name: test_data_for_https_to_clickhouse
    resolver: sql
    properties:
      connector: clickhouse
      sql: "select * from https_to_clickhouse order by id"
    result_csv: |
      id,boolean_col,int32_col,int64_col,float_col,double_col,byte_array_col,fixed_len_byte_array_col,string_col,decimal_col,date_col,time_millis_col,time_micros_col,timestamp_millis_col,timestamp_micros_col,uuid_col,list_int_col,list_string_col,map_col,struct_col
      1,true,123,45678901234,1.23,3.14159,abcd,1234567890abcdef,hello,123.45,2024-03-06,00:02:03.456000,00:02:03.456789,2024-03-06T12:34:56Z,2024-03-06T12:34:56Z,uuidabcd1234efgh,[1 2 3],['apple' 'banana' 'cherry'],"[('key1', 10), ('key2', 20)]","{'field_int_col': 42, 'field_float_col': 3.140000104904175, 'field_string_col': 'example'}"
      2,false,0,0,0,0,,0000000000000000,,0,1970-01-01,00:00:00,00:00:00,1970-01-01T00:00:00Z,1970-01-01T00:00:00Z,0000000000000000,[],[],[],"{'field_int_col': 0, 'field_float_col': 0.0, 'field_string_col': ''}"
      3,false,0,0,0,0,,,,0,1970-01-01,,,1970-01-01T00:00:00Z,1970-01-01T00:00:00Z,,,,,
  - name: test_data_for_https_to_duckdb
    resolver: sql
    properties:
      connector: duckdb
      sql: "select * from https_to_duckdb order by id"
    result_csv: |
      id,boolean_col,int32_col,int64_col,float_col,double_col,byte_array_col,fixed_len_byte_array_col,string_col,decimal_col,date_col,time_millis_col,time_micros_col,timestamp_millis_col,timestamp_micros_col,uuid_col,list_int_col,list_string_col,map_col,struct_col
      1,true,123,45678901234,1.23,3.14159,abcd,1234567890abcdef,hello,123.45,2024-03-06,0001-01-01T00:02:03.456Z,0001-01-01T00:02:03.456789Z,2024-03-06T12:34:56.789Z,2024-03-06T12:34:56.789123Z,uuidabcd1234efgh,[1 2 3],['apple' 'banana' 'cherry'],"[('key1', 10), ('key2', 20)]","{'field_int_col': 42, 'field_float_col': 3.140000104904175, 'field_string_col': 'example'}"
      2,false,0,0,0,0,,0000000000000000,,0,1970-01-01,0001-01-01T00:00:00Z,0001-01-01T00:00:00Z,1970-01-01T00:00:00Z,1970-01-01T00:00:00Z,0000000000000000,[],[],[],"{'field_int_col': 0, 'field_float_col': 0.0, 'field_string_col': ''}"
      3,,,,,,,,,,,,,,,,,,,
