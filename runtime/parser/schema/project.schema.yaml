$schema: 'http://json-schema.org/draft-07/schema#'
$id: project.schema.yaml
title: YAML Syntax
type: object
description: |
  When you create models and dashboards, these objects are represented as object files on the file system. You can find these files in your `models` and `dashboards` folders in your project by default. 

  :::info Working with resources outside their native folders

  It is possible to define resources (such as [models](advanced-models.md), [metrics-views](metrics-views.md), [dashboards](explore-dashboards.md), [custom APIs](apis.md), or [themes](themes.md)) within <u>any</u> nested folder within your Rill project directory. However, for any YAML configuration file, it is then imperative that the `type` property is then appropriately defined within the underlying resource configuration or Rill will not able to resolve the resource type correctly!

  :::

  Projects can simply be rehydrated from Rill project files into an explorable data application as long as there is sufficient access and credentials to the source data - figuring out the dependencies, pulling down data, & validating your model queries and metrics configurations. The result is a set of functioning exploratory dashboards.

  You can see a few different example projects by visiting our [example github repository](https://github.com/rilldata/rill-examples).

  :::tip

  For more information about using Git or cloning projects locally, please see our page on [GitHub Basics](/deploy/deploy-dashboard/github-101).

  :::
oneOf:
  - $ref: 'alerts.schema.yaml#'
  - $ref: 'apis.schema.yaml#'
  - $ref: 'canvas-dashboards.schema.yaml#'
  # - $ref: 'component.schema.yaml#'
  - $ref: 'connectors.schema.yaml#'
  - $ref: 'explore-dashboards.schema.yaml#'
  - $ref: 'metrics_views.schema.yaml#'
  - $ref: 'advanced-models.schema.yaml#'
  - $ref: 'themes.schema.yaml#'
definitions:
  common_properties:
    type: object
    title: "Common Properties"
    properties:
      name:
        type: string
        description: Name is usually inferred from the filename, but can be specified manually.
      refs:
        type: array
        description: 'List of resource references'
        items:
          type: string
          description: A string reference like `<resource-name>` or `<type/resource-name>`.
      dev:
        type: object
        description: Overrides any properties in development environment.
      prod:
        type: object
        description: Overrides any properties in production environment.
  component_variable_properties:
    type: object
    properties:
      name:
        type: string
        description: Unique identifier for the variable
      type:
        type: string
        description: Data type of the variable (e.g., string, number, boolean)
      value:
        description: Default value for the variable. Can be any valid JSON value type
        type:
          - string
          - number
          - boolean
          - object
          - array
    required:
      - name
      - type
    additionalProperties: false
  data_properties:
    oneOf:
      - title: SQL Query
        type: object
        description: Executes a raw SQL query against the project's data models.
        properties:
          sql:
            type: string
            description: Raw SQL query to run against existing models in the project.
          connector:
            type: string
            description: specifies the connector to use when running SQL or glob queries.
        required:
          - sql
      - title: Metrics View Query
        type: object
        description: Executes a SQL query that targets a defined metrics view.
        properties:
          metrics_sql:
            type: string
            description: SQL query that targets a metrics view in the project
        required:
          - metrics_sql
      - title: Custom API Call
        type: object
        description: Calls a custom API defined in the project to compute data.
        properties:
          api:
            type: string
            description: Name of a custom API defined in the project.
          args:
            type: object
            description: Arguments to pass to the custom API.
            additionalProperties: true
        required:
          - api
      - title: File Glob Query
        type: object
        description: Uses a file-matching pattern (glob) to query data from a connector.
        properties:
          glob:
            description:  Defines the file path or pattern to query from the specified connector.
            anyOf:
              - type: string
                description: A simple file path/glob pattern as a string.
              - type: object
                description: An object-based configuration for specifying a file path/glob pattern with advanced options.
                additionalProperties: true
          connector:
            type: string
            description: Specifies the connector to use with the glob input.
        required:
          - glob
      - title: Resource Status Check
        type: object
        description: Uses the status of a resource as data.
        properties:
          resource_status:
            type: object
            description: Based on resource status
            properties:
              where_error:
                type: boolean
                description: Indicates whether the condition should trigger when the resource is in an error state.
            additionalProperties: true
        required:
          - resource_status
  explore_time_range_properties:
    oneOf:
      - type: string
        description: a valid [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601#Durations) duration or one of the [Rill ISO 8601 extensions](https://docs.rilldata.com/reference/rill-iso-extensions#extensions) extensions for the selection
      - type: object
        description: Object containing time range and comparison configuration
        properties:
          range:
            type: string
            description: a valid [ISO 8601](https://en.wikipedia.org/wiki/ISO_8601#Durations) duration or one of the [Rill ISO 8601 extensions](https://docs.rilldata.com/reference/rill-iso-extensions#extensions) extensions for the selection
          comparison_offsets:
            type: array
            description: list of time comparison options for this time range selection (optional). Must be one of the [Rill ISO 8601 extensions](https://docs.rilldata.com/reference/rill-iso-extensions#extensions)
            items:
              oneOf:
                - type: string
                  description: Offset string only (range is inferred)
                - type: object
                  description: Object containing offset and range configuration for time comparison
                  properties:
                    offset:
                      type: string
                      description: Time offset for comparison (e.g., 'P1D' for one day ago)
                    range:
                      type: string
                      description: Custom time range for comparison period
                  additionalProperties: false
        required:
          - range
        additionalProperties: false
  notify_properties:
    type: object
    properties:
      email:
        type: object
        description: Send notifications via email.
        properties:
          recipients:
            type: array
            description: An array of email addresses to notify.
            items:
              type: string
            minItems: 1
        required:
          - recipients
      slack:
        type: object
        description: Send notifications via Slack.
        properties:
          users:
            type: array
            description: An array of Slack user IDs to notify.
            items:
              type: string
            minItems: 1
          channels:
            type: array
            description: An array of Slack channel IDs to notify.
            items:
              type: string
            minItems: 1
          webhooks:
            type: array
            description: An array of Slack webhook URLs to send notifications to.
            items:
              type: string
            minItems: 1
        anyOf:
          - required:
              - channels
          - required:
              - users
          - required:
              - webhooks
    anyOf:
        - required:
          - slack
        - required:
          - email
  schedule_properties:
    type: object
    properties:
      cron:
        type: string
        description: A cron expression that defines the execution schedule
      time_zone:
        type: string
        description: Time zone to interpret the schedule in (e.g., 'UTC', 'America/Los_Angeles').
      disable:
        type: boolean
        description: 'If true, disables the resource without deleting it.'
      ref_update:
        type: boolean
        description: 'If true, allows the resource to run when a dependency updates.'
      run_in_dev:
        type: boolean
        description: 'If true, allows the schedule to run in development mode.'
  security_policy_properties:
    type: object
    description: Defines security rules and access control policies for resources
    properties:
      access:
        oneOf:
          - type: string
            description: SQL expression that evaluates to a boolean to determine access
          - type: boolean
            description: Direct boolean value to allow or deny access
        description: Expression indicating if the user should be granted access to the dashboard. If not defined, it will resolve to false and the dashboard won't be accessible to anyone. Needs to be a valid SQL expression that evaluates to a boolean.
      row_filter:
        type: string
        description: SQL expression to filter the underlying model by. Can leverage templated user attributes to customize the filter for the requesting user. Needs to be a valid SQL expression that can be injected into a WHERE clause
      include:
        type: array
        description: List of dimension or measure names to include in the dashboard. If include is defined all other dimensions and measures are excluded
        items:
          type: object
          properties:
            if:
              type: string
              description: Expression to decide if the column should be included or not. It can leverage templated user attributes. Needs to be a valid SQL expression that evaluates to a boolean
            names:
              anyOf:
                - type: array
                  description: List of specific field names to include
                  items:
                    type: string
                - type: string
                  description: Wildcard '*' to include all fields
                  enum:
                    - '*'
              description: List of fields to include. Should match the name of one of the dashboard's dimensions or measures
          required:
            - if
            - names
      exclude:
        type: array
        description: List of dimension or measure names to exclude from the dashboard. If exclude is defined all other dimensions and measures are included
        items:
          type: object
          properties:
            if:
              type: string
              description: Expression to decide if the column should be excluded or not. It can leverage templated user attributes. Needs to be a valid SQL expression that evaluates to a boolean
            names:
              anyOf:
                - type: array
                  description: List of specific field names to exclude
                  items:
                    type: string
                - type: string
                  description: Wildcard '*' to exclude all fields
                  enum:
                    - '*'
              description: List of fields to exclude. Should match the name of one of the dashboard's dimensions or measures
          required:
            - if
            - names
      rules:
        type: array
        description: List of detailed security rules that can be used to define complex access control policies
        items:
          type: object
          description: Individual security rule definition
          properties:
            type:
              type: string
              enum:
                - access
                - field_access
                - row_filter
              description: Type of security rule - access (overall access), field_access (field-level access), or row_filter (row-level filtering)
            action:
              type: string
              enum:
                - allow
                - deny
              description: Whether to allow or deny access for this rule
            if:
              type: string
              description: Conditional expression that determines when this rule applies. Must be a valid SQL expression that evaluates to a boolean
            names:
              type: array
              items:
                type: string
              description: List of field names this rule applies to (for field_access type rules)
            all:
              type: boolean
              description: When true, applies the rule to all fields (for field_access type rules)
            sql:
              type: string
              description: SQL expression for row filtering (for row_filter type rules)
          required:
            - type
