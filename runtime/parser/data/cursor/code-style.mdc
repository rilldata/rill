---
description: Code Style for Rill Projects
globs: ["**/*.sql", "**/*.yaml", "**/*.yml"]
alwaysApply: false
---

# Rill Code Style

## Naming Conventions

- Use snake_case for all files and identifiers
- Include grain in time-based model names: `events_hourly`, `orders_daily`
- Suffix dimension tables with `_dim`: `customer_dim`, `product_dim`
- Suffix raw/staging with `_raw` or `_stg`: `transactions_raw`

**Examples**:
```
models/orders_daily.sql       ✓ Clear grain
models/OrdersDaily.sql        ✗ Wrong case
models/orders.sql             ~ Missing grain context
```

## SQL Style

**Keywords**: UPPERCASE for SQL keywords
**Columns**: One per line in SELECT, explicit lists (no SELECT *)
**Joins**: Always use explicit JOIN with ON clause
**Line length**: ~100 characters max

**Example**:
```sql
-- models/orders_daily.sql
-- Aggregates orders to daily grain for metrics

SELECT
  DATE_TRUNC('day', order_timestamp) AS order_date,
  customer_id,
  COUNT(*) AS order_count,
  SUM(total_amount) AS total_revenue
FROM {{ ref('orders_raw') }}
WHERE order_status = 'completed'
GROUP BY 1, 2
```

**Anti-pattern**:
```sql
-- ✗ Avoid
SELECT * FROM orders, customers WHERE orders.customer_id = customers.id
```

## YAML Style

- 2-space indentation
- Group related fields together
- Add comments for non-obvious config

**Example**:
```yaml
type: metrics_view
model: orders_daily

timeseries: order_date

dimensions:
  - name: customer_id
    label: Customer ID
    description: Unique customer identifier

measures:
  - name: total_revenue
    expression: SUM(total_revenue)
    format_preset: currency_usd
```

## Documentation

- Add header comment to SQL models explaining purpose
- Document complex transformations inline
- Keep comments concise and up-to-date
